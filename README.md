# BigQueryでGA4のセッション参照元情報を作成
GA4はレコードがイベント単位なので、セッションの参照元はセッション単位で集計してから取得する必要があります。
session_traffic_source_last_clickカラムが追加されてからはこちらを使えるようになりましたが、イベントパラメータやcollected_traffic_sourceカラムを優先したい場合のクエリになります。

# 処理手順
1. 参照元の追加処理。session_startの参照元などを取得。優先順位はcollected_traffic_sourceカラム＞event_params.sourceカラム＞session_traffic_source_last_clickカラムの順。
2. 参照元などが入っているイベントのうち一番古いものを取得
3. session_startに参照元が入っていればそれを採用。ない場合はイベントから取得。
   - session_traffic_mediumなどでもIF(s.event_traffic_source IS NOT NULLとしているのは、event_traffic_mediumとしてしまうと、sourceはsession_startから取得しmediumは最初のイベントから取得というミスを防ぐため
5. 過去にセッション情報が存在する場合はそれを採用(user_pseudo_id、ga_session_id、session_traffic_sourceなどをsessionsテーブルに格納するクエリを別途要作成)
